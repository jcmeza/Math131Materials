<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Analysis Lecture Notes - 2&nbsp; Taylor’s Theorem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Errors.html" rel="next">
<link href="./Foundations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Intro.html">Introduction</a></li><li class="breadcrumb-item"><a href="./TaylorTheorem.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylor’s Theorem</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Intro.html">Introduction</a></li><li class="breadcrumb-item"><a href="./TaylorTheorem.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylor’s Theorem</span></a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylor’s Theorem</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Analysis Lecture Notes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TaylorTheorem.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylor’s Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FloatPointSys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Floating Point Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IEEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">IEEE Floating Point Standard</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AlgorithmsCondition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Stability and Conditioning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./RootsEqn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonlinear Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bisect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bisection Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Newton’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Secant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Secant Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Fixed Point Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtEU.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Point Existence and Uniqueness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtQConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 2)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./PolyInterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolation and Approximation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpLagr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Lagrange Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpDividedDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Divided Differences and Newton Interpolating Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpErr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interpolation Error</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpCubicSplines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Piecewise Polynomials and Cubic Splines</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FwdDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Finite Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HigherOrderFD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Finite Differences via Lagrange Polynomials (Optional)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDStability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Richardson Extrapolation and Finite Difference Stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerIntegr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Integration (Quadrature)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntBasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Numerical Integration Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntNewtonCotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Newton-Cotes Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntComposite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntAdaptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Adaptive Quadrature</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./IVPODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Initial-Value Problems for ODEs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Euler’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEulerErrAny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Error Analysis for Euler’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPHigherOrder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPMultistep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BigONotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Big O Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPExtUniq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Existence and Uniqueness of IVP</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">DataSets</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#taylor-polynomials" id="toc-taylor-polynomials" class="nav-link active" data-scroll-target="#taylor-polynomials"><span class="header-section-number">2.1</span> Taylor Polynomials</a></li>
  <li><a href="#taylors-theorem" id="toc-taylors-theorem" class="nav-link" data-scroll-target="#taylors-theorem"><span class="header-section-number">2.2</span> Taylor’s Theorem</a></li>
  <li><a href="#examplesexercises" id="toc-examplesexercises" class="nav-link" data-scroll-target="#examplesexercises"><span class="header-section-number">2.3</span> Examples/Exercises</a></li>
  <li><a href="#other-forms-for-the-remainder-term" id="toc-other-forms-for-the-remainder-term" class="nav-link" data-scroll-target="#other-forms-for-the-remainder-term"><span class="header-section-number">2.4</span> Other forms for the Remainder Term</a></li>
  <li><a href="#choosing-p_nx-to-achieve-a-desired-accuracy" id="toc-choosing-p_nx-to-achieve-a-desired-accuracy" class="nav-link" data-scroll-target="#choosing-p_nx-to-achieve-a-desired-accuracy"><span class="header-section-number">2.5</span> Choosing <span class="math inline">\(P_n(x)\)</span> to achieve a desired accuracy</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">2.6</span> Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">2.7</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<blockquote class="blockquote">
<p><em>All models are wrong but some models are useful</em></p>
<p><em>George E.P. Box</em></p>
</blockquote>
<p><strong>Topics Covered:</strong></p>
<ul>
<li><p>How can we approximate mathematical functions that cannot be evaluated exactly?</p></li>
<li><p>How does the approximation behave near the approximation point?</p></li>
<li><p>Can we quantify the error in the approximation?</p></li>
</ul>
<section id="taylor-polynomials" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="taylor-polynomials"><span class="header-section-number">2.1</span> Taylor Polynomials</h2>
<p>A fact that is highly underappreciated is that most functions in mathematics cannot be evaluated exactly. Common examples include functions such as <span class="math inline">\(\exp(x), \cos(x), \ln(x)\)</span>.</p>
<p>This leads us to consider ways to approximate a function <span class="math inline">\(f(x)\)</span> by something else that is easier to compute. Let’s consider the simple case of the exponential:</p>
<p><span class="math display">\[
\exp(x) = \sum_{k=0}^{\infty} \frac{x^k}{k!} = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \ldots
\]</span></p>
<p>The first approximation we might try is <span class="math inline">\(1+x\)</span>, which is clearly easy to compute, but likely not very accurate. A second attempt might be to use the first three terms <span class="math inline">\(1 + x + \frac{x^2}{2}\)</span>. We could proceed in the obvious way, adding new terms until we are satisifed or we get tired.</p>
<p>But there is an underlying question - when should we stop? One would hope that as <span class="math inline">\(k\)</span> increases we should get more accuracy, but it’s also clear that the more terms we use the harder is to compute the approximation.</p>
<p><strong>Goal:</strong> Find functions that <em>approximate</em> <span class="math inline">\(f\)</span> at some point, but with some <em>guarantee of accuracy</em>. Hopefully, these approximating functions are also <em>cheaper</em> to compute than the original function.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>In numerical analysis there is a constant trade off between accuracy and computational work. We seek to balance these two goals for a given problem.</p>
</div>
</div>
<p>A first natural approach is to use a polynomial. They are 1) easy to understand, 2) easy to compute, and 3) in general easier to analyze. One commonly used approach is that of approximating a function via a Taylor polynomial. In addition, we will see that Taylor’s Theorem with remainder can be used to analyze our approximations. You should be familiar with both the concepts and how to apply them in different situations.</p>
<div id="def-Taylorpoly" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.1 (Taylor Polynomials)</strong></span> Suppose <span class="math inline">\(f\)</span> is a function with <span class="math inline">\(n\)</span> derivatives at the point <span class="math inline">\(x=x_0.\)</span> Then the <span class="math inline">\(n\)</span>th Taylor polynomial for <span class="math inline">\(f\)</span> at <span class="math inline">\(x_0\)</span> is given by:</p>
<p><span id="eq-taylorpoly"><span class="math display">\[
P_n(x) = f(x_0) + (x-x_0) f^{\prime}(x_0)+ \frac{(x-x_0)^2}{2!}f^{\prime\prime}(x_0) + \cdots + \frac{(x-x_0)^n}{n!} f^{(n)}(x_0)
\tag{2.1}\]</span></span></p>
</div>
<p>Let’s take a quick look at how some of the approximations work on <span class="math inline">\(exp(x).\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Figures/desmos-graph-expapprox.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>First and second order approximations to <span class="math inline">\(e^x\)</span>. Red is exp(x), green is <span class="math inline">\(1 + x + x^2/2\)</span>, blue is <span class="math inline">\(1 + x\)</span></figcaption>
</figure>
</div>
<p>Some observations:</p>
<ul>
<li><p>As <span class="math inline">\(n\)</span> increases, we might expect accuracy to increase</p></li>
<li><p>As we move away from the selected point <span class="math inline">\(x_0\)</span>, we might expect the accuracy to decrease.</p></li>
</ul>
<p>Using Taylor polynomials to approximate a function <span class="math inline">\(f(x)\)</span> leads to several natural questions:</p>
<ol type="1">
<li><p>How do we know all the derivatives exist?</p></li>
<li><p>What is the error when approximating <span class="math inline">\(f(x)\)</span> by <span class="math inline">\(P_n(x)\)</span>?</p></li>
<li><p>Given a desired accuracy, how do we choose <span class="math inline">\(n\)</span>?</p></li>
</ol>
<p>The question of the existence of all of the derivatives is a non-trivial one. We will have need of them in order to analyze the approximation, but in practice, one rarely has more than the first derivatives available. For the remainder of the course, we will assume that we have enough derivatives to allow us to proceed with our analysis, but the student should be aware that such assumptions are difficult to establish in real-world problems.</p>
</section>
<section id="taylors-theorem" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="taylors-theorem"><span class="header-section-number">2.2</span> Taylor’s Theorem</h2>
<p>In order to answer questions 2-3 above, we will need the following theorem.</p>
<div id="thm-Taylorthem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.1 (Taylor’s Theorem with remainder)</strong></span> Let <span class="math inline">\(f \in C^{n+1}\)</span> on an interval <span class="math inline">\(I\)</span> containing the real number <span class="math inline">\(x_0\)</span>. Also, let <span class="math inline">\(P_n(x)\)</span> be the <span class="math inline">\(n\)</span>th Taylor polynomial of <span class="math inline">\(f\)</span> at <span class="math inline">\(x_0\)</span> as defined by <a href="#eq-taylorpoly" class="quarto-xref">Equation&nbsp;<span>2.1</span></a>. Then for each <span class="math inline">\(x\)</span> in <span class="math inline">\(I\)</span>, we can write <span class="math display">\[
f(x) = P_n(x) + R_n(x),
\]</span> where <span class="math inline">\(R_n(x)\)</span> is given by: <span class="math display">\[
R_n(x) = \frac{(x-x_0)^{n+1} }{(n+1)!} f^{(n+1)}(\xi),  
\]</span> for some <span class="math inline">\(\xi\)</span> between <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x\)</span>.</p>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<p>It is important to note that the value of <span class="math inline">\(\xi\)</span> will depend on <span class="math inline">\(x\)</span>, (and hence the derivative term <span class="math inline">\(f^{n+1}(\xi)\)</span>).</p>
</div>
</div>
</div>
<p>Taylor’s theorem will prove to be incredibly useful in our analysis of algorithms. In particular, we will use it to determine the accuracy of various approximations and more importantly it will be essential in the error analysis of algorithms.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remark
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will have use of other forms of Taylor’s Theorem - you should get comfortable recognizing and using them. For example, use the substitution <span class="math inline">\(h = x - x_0\)</span> to rewrite Taylor’s Theorem.</p>
</div>
</div>
</section>
<section id="examplesexercises" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="examplesexercises"><span class="header-section-number">2.3</span> Examples/Exercises</h2>
<div id="exm-taylor1" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.1</strong></span> Consider <span class="math inline">\(f(x) = \exp(x)\)</span>. Evaluate the <span class="math inline">\(nth\)</span> Taylor polynomial about the point <span class="math inline">\(x_0 = 0\)</span> and evaluate its remainder at <span class="math inline">\(x_0\)</span>.</p>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
</div>
<div class="line-block"><br>
First we write down the Taylor Polynomial for <span class="math inline">\(f(x) = \exp(x)\)</span> at <span class="math inline">\(x_0\)</span>.<br>
<span class="math display">\[  P_n(x) = f(x_0) + (x-x_0) f^{\prime}(x_0)+ \frac{(x-x_0)^2}{2!}f^{\prime\prime}(x_0) + \cdots + \frac{(x-x_0)^n}{n!} f^{(n)}(x_0)  \]</span><br>
Next we note that <span class="math inline">\(f^{(k)}(x) = \exp(x), k = 0, 1, 2, \ldots\)</span>, so all of the derivatives exist. In particular, for the point <span class="math inline">\(x_0 = 0\)</span>, we can also evaluate the function and all of its derivatives, <span class="math inline">\(e^{x_0} = e^0 = 1 , \forall \ k = 0, 1, \ldots .\)</span><br>
<br>
That means we can write the Taylor polynomial and the remainder term as follows:<br>
<br>
<span class="math display">\[  \begin{aligned} P_n(x) &amp;= 1 + x + \frac{x^2}{2!} + \cdots + \frac{x^n}{n!} \\ R_n(x) &amp;= \frac{x^{n+1} }{(n+1)!} \large{ e ^{\xi(x)}}, \end{aligned} \]</span><br>
<br>
<br>
</div>
<div id="exr-taylor1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.1 (In class exercise)</strong></span> Consider <span class="math inline">\(f(x) = \sqrt[3]{x}\)</span>. a) Find the first and second Taylor Polynomials for <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x_0=8\)</span>. b) Evaluate both Taylor polynomials at the point <span class="math inline">\(x=11\)</span>.</p>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
</div>
<ol type="a">
<li>Let’s break this down into steps:</li>
</ol>
<p><strong>Step 1.</strong> Writing out the first two polynomials using Taylor’s theorem we see that:</p>
<p><span class="math display">\[
\begin{aligned}  
P_1(x) &amp;= f(x_0) + (x-x_0) f^{\prime}(x_0) \\  
P_2(x) &amp;= f(x_0) + (x-x_0) f^{\prime}(x_0)+ \frac{(x-x_0)^2}{2!}f^{\prime\prime}(x_0)
\end{aligned}  
\]</span> <strong>Step 2.</strong> Now let’s substitue for the point <span class="math inline">\(x_0=8\)</span>: <span id="eq-taylorp1p2"><span class="math display">\[
\begin{aligned}
P_1(x) &amp;= f(8) + (x-8) f^{\prime}(8) \\  
P_2(x) &amp;= f(8) + (x-8) f^{\prime}(8)+ \frac{(x-8)^2}{2!}f^{\prime\prime}(8)  
\end{aligned}
\tag{2.2}\]</span></span> <strong>Step 3.</strong> The next step is to calculate the various derivative terms in the polynomial and evaluate them at the point <span class="math inline">\(x_0=8\)</span>. It is helpful to write out a table that includes all of the necessary terms as shown below.</p>
<table class="table">
<caption>Taylor Polynomial terms for <span class="math inline">\(\sqrt[3] x\)</span></caption>
<colgroup>
<col style="width: 41%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Evaluation at <span class="math inline">\(x_0=8\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(f(x) = \large{\sqrt[3] x}\)</span></td>
<td><span class="math inline">\(f(8) = \large{\sqrt[3] 8} = 2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(f^\prime(x) = \Large{\frac{1}{3x^{2/3}}}\)</span></td>
<td><span class="math inline">\(f^\prime(8)= \Large{\frac{1}{3\cdot 8^{2/3}}} = \frac{1}{12}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(f^{\prime \prime}(x) = \Large{\frac{-2}{9x^{5/3}}}\)</span></td>
<td><span class="math inline">\(f^{\prime \prime}(8) = -\Large{\frac{2}{9\cdot 8^{5/3}}} = - \frac{1}{144}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Finally, inserting these values into <a href="#eq-taylorp1p2" class="quarto-xref">Equation&nbsp;<span>2.2</span></a> yields:</p>
<p><span class="math display">\[
\begin{aligned}
P_1(x) &amp;= 2 + \frac{(x-8)}{12} \\  
P_2(x) &amp;= 2 + \frac{(x-8)}{12} - \frac{(x-8)^2}{288}  
\end{aligned}
\]</span></p>
<ol start="2" type="a">
<li>Estimate <span class="math inline">\(f(11) = {\sqrt[3] 11}\)</span></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
P_1(11) &amp;= 2 + \frac{(11-8)}{12} = 2.25 \\  
P_2(11) &amp;= 2 + \frac{(11-8)}{12} - \frac{(11-8)^2}{288} = 2.21875  
\end{aligned}  
\]</span></p>
<p>For comparison, <span class="math inline">\({\normalsize \sqrt[3] 11 } \approx {\normalsize 2.22398009}\)</span></p>
</section>
<section id="other-forms-for-the-remainder-term" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="other-forms-for-the-remainder-term"><span class="header-section-number">2.4</span> Other forms for the Remainder Term</h2>
<p>There are alternate forms for the remainder term that you may see, the most common of which is the <em>integral form</em>, which is given by:</p>
<p><span class="math display">\[
R_n(x) = \frac{1}{n!} \int_{x_0}^{x} (x - t)^n f^{(n+1)}(t) dt,  
\]</span></p>
<p>It is fairly easy to show that the two forms are equivalent through the use of the Weighted Mean Value Theorem for Integrals (<a href="Foundations.html#thm-wmvti" class="quarto-xref">Theorem&nbsp;<span>1.3</span></a>). First note that the first term <span class="math inline">\((x-t)^n\)</span> does not change sign over the interval <span class="math inline">\([x_0, x]\)</span>. Also by assumption <span class="math inline">\(f^{(n+1)}\)</span> is continuous on the same interval. As a result, we can use the WMVTI as follows.</p>
<p><span class="math display">\[
\begin{aligned}
\int_{x_0}^{x} (x - t)^n f^{(n+1)}(t) dt &amp;=  f^{(n+1)}(\xi) \int_{x_0}^{x} (x - t)^n  dt, \\
&amp;= f^{(n+1)}(\xi) \cdot \frac{\quad - (x - t)^{n+1}}{n+1} \Bigg| _{x_0}^x, \\
&amp;= f^{(n+1)}(\xi) \cdot \frac{\quad (x - x_0)^{n+1}}{n+1}.
\end{aligned}
\]</span></p>
<p>The last step follows since the integrand vanishes at the upper endpoint. If We now multiply both sides by <span class="math inline">\(1/n!\)</span> we get the desired result.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remark
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are other forms of the remainder term as well. The ones presented here are the most common. Which form you decide to use will depend on the particular situation. But it’s nice to have options.</p>
</div>
</div>
</section>
<section id="choosing-p_nx-to-achieve-a-desired-accuracy" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="choosing-p_nx-to-achieve-a-desired-accuracy"><span class="header-section-number">2.5</span> Choosing <span class="math inline">\(P_n(x)\)</span> to achieve a desired accuracy</h2>
<p>This now leaves us with our finaly question: can we determine what degree polynomial is required for a given accuracy?</p>
<div id="exm-taylor2" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.2</strong></span> Once again, let’s consider <span class="math inline">\(f(x) = \exp(x)\)</span>. Evaluate the <span class="math inline">\(nth\)</span> Taylor polynomial about the point <span class="math inline">\(x_0 = 0\)</span>. How big should <span class="math inline">\(n\)</span> be to approximate <span class="math inline">\(\exp(1)\)</span> to an accuracy of <span class="math inline">\(10^{-9}.\)</span></p>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
</div>
<p>Recall that <span class="math display">\[
R_n(x) = \frac{x^{n+1}}{(n+1)!} \cdot \large{e^{\xi}}
\]</span> Evaluating at <span class="math inline">\(x = 1\)</span> gives us <span class="math display">\[
R_n(x) = \frac{1}{(n+1)!} \cdot \large{e^\xi}
\]</span> Our overall goal is to bound the remainder (error) such that: <span class="math display">\[
l \leq R_n(1) \leq u
\]</span> where <span class="math inline">\(l,u\)</span> are some chosen bounds. In general it will be easier to work with the following form:</p>
<p><span class="math display">\[
| R_n(1) | \leq M
\]</span> for some value of <span class="math inline">\(M\)</span>, in this case e.g.&nbsp;we would let <span class="math inline">\(M = 10^{-9}\)</span>.</p>
<p>As with many cases in numerical analysis, we will need to make use of any information we may have about the function and the domain we’re working with. In particular for this function we know that, <span class="math inline">\(0 &lt; \xi &lt; 1,\)</span> by Taylor’s Theorem. That means that: <span class="math display">\[
1 = \large{e^0} &lt; \large{e^\xi} &lt; \large{e^1} = \large{e}
\]</span> dividing by <span class="math inline">\((n+1)!\)</span> we see that: <span class="math display">\[
\frac{1}{(n+1)!} &lt; \frac{\large{e^\xi}}{(n+1)!} &lt;  \frac{\large{e}}{(n+1)!}
\]</span> Note that the middle term is just <span class="math inline">\(R_n(1)\)</span>. Since we’re not supposed to actually know the value of <span class="math inline">\(\large{e}\)</span>, let’s just assume that we know a rough upper bound, say 3, (but we could just as easily have used any other number) and substitute it into the last term. Then what we’re really saying is that we would like to have: <span class="math display">\[
| R_n(1) | &lt; \frac{3}{(n+1)!} &lt; 10^{-9}
\]</span> A quick calculation suggests that <span class="math inline">\(n+1 \geq 13\)</span> satisfies this condition, so that a <span class="math inline">\(12th\)</span> degree Taylor polynomial should gives us the desired accuracy.</p>
<div id="exr-taylor2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.2 (In class exercise)</strong></span> &nbsp;</p>
<ol type="a">
<li>Write out the <span class="math inline">\(nth\)</span> Taylor Polynomial for <span class="math inline">\(f(x) = \sin (x)\)</span> about <span class="math inline">\(\pi/4\)</span>.</li>
<li>Find the smallest degree Taylor polynomial such that the remainder <span class="math display">\[
| R_n(\pi/4) | &lt; 10^{-6}
\]</span>on <span class="math inline">\([0, \pi/4]\)</span>.</li>
</ol>
</div>
</section>
<section id="summary" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="summary"><span class="header-section-number">2.6</span> Summary</h2>
<ul>
<li><p>We showed that we can approximate a given function through the use of a Taylor Polynomial.</p></li>
<li><p>Taylor’s Theorem allows us to write down exactly what the remainder (error) term is.</p></li>
<li><p>Two (equivalent) forms of the remainder term were introduced: Lagrange form and the Integral Form.</p></li>
<li><p>We can estimate the degree of the Taylor Polynomial needed to guarantee a desired accuracy over a given interval.</p></li>
<li><p>Useful bounds will depend on knowledge of the given function and its derivatives.</p></li>
</ul>
</section>
<section id="references" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="references"><span class="header-section-number">2.7</span> References</h2>
<p>A good online reference for some of the material above can be found at <a href="https://openstax.org/">openstax.org</a>.</p>
<ul>
<li><a href="https://openstax.org/books/calculus-volume-2/pages/6-3-taylor-and-maclaurin-series">Taylor polynomials and Taylor’s Theorem</a></li>
</ul>
<p>Another good set of resources are the one-pagers provided by the UCM Math Center. You can check them all out at: <a href="https://mathcenter.ucmerced.edu/student-resources">UCM The Math Center</a> and in particular the Math 23 refresher one-pager might prove useful: <a href="https://mathcenter.ucmerced.edu/sites/mathcenter.ucmerced.edu/files/page/documents/math_23_refresher.pdf">Math 23 refresher</a>.</p>
<p>And of course, there’s always Wikepedia:<a href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">Taylor’s Theorem</a></p>
<p>Revised: Tuesday, Sept.&nbsp;5, 2023</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Foundations.html" class="pagination-link" aria-label="Foundations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Errors.html" class="pagination-link" aria-label="Errors">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Errors</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Numerical Analysis Lecture Notes, Juan C. Meza, jcmeza@ucmerced.edu, 2023</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>