<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Analysis Lecture Notes - 24&nbsp; Composite Quadrature Rules</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./NumIntAdaptive.html" rel="next">
<link href="./NumIntNewtonCotes.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NumerIntegr.html">Numerical Integration (Quadrature)</a></li><li class="breadcrumb-item"><a href="./NumIntComposite.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NumerIntegr.html">Numerical Integration (Quadrature)</a></li><li class="breadcrumb-item"><a href="./NumIntComposite.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Analysis Lecture Notes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TaylorTheorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylor’s Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FloatPointSys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Floating Point Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IEEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">IEEE Floating Point Standard</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AlgorithmsCondition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Stability and Conditioning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./RootsEqn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonlinear Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bisect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bisection Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Newton’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Secant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Secant Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Fixed Point Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtEU.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Point Existence and Uniqueness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtQConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 2)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./PolyInterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolation and Approximation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpLagr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Lagrange Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpDividedDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Divided Differences and Newton Interpolating Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpErr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interpolation Error</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpCubicSplines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Piecewise Polynomials and Cubic Splines</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FwdDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Finite Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HigherOrderFD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Finite Differences via Lagrange Polynomials (Optional)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDStability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Richardson Extrapolation and Finite Difference Stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerIntegr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Integration (Quadrature)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntBasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Numerical Integration Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntNewtonCotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Newton-Cotes Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntComposite.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntAdaptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Adaptive Quadrature</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./IVPODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Initial-Value Problems for ODEs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Euler’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEulerErrAny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Error Analysis for Euler’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPHigherOrder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPMultistep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BigONotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Big O Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPExtUniq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Existence and Uniqueness of IVP</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">DataSets</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-composite-integration" id="toc-sec-composite-integration" class="nav-link active" data-scroll-target="#sec-composite-integration"><span class="header-section-number">24.1</span> Composite Integration</a></li>
  <li><a href="#error-analysis-and-stability" id="toc-error-analysis-and-stability" class="nav-link" data-scroll-target="#error-analysis-and-stability"><span class="header-section-number">24.2</span> Error Analysis and Stability</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">24.3</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="sec-composite-integration" class="level2 page-columns page-full" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="sec-composite-integration"><span class="header-section-number">24.1</span> Composite Integration</h2>
<p>In practice we can’t use Newton-Cotes over large intervals as it would require high degree polynomials, which would be unsuitable due to the highly oscillatory nature. Another disadvantage is that we would need to have equally spaced intervals, which are not suitable for many physical applications.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Instead of trying to approximate the integral accurately over the entire interval with one polynomial, break up the domain into smaller regions and use low-order polynomials on each of them.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Divide and Conquer (Redux)
</div>
</div>
<div class="callout-body-container callout-body">
<p>The idea behind breaking the original problem into several smaller problems is used in many situations and is often referred to as a divide-and-conquer strategy. Recall, that we used a similar approach in <a href="InterpCubicSplines.html#sec-interppiecewisepoly" class="quarto-xref"><span>Section 18.1</span></a> when we chose to break up the problem of interpolation via piecewise functions over a set of sub-intervals instead of one single interpolating polynomial.</p>
</div>
</div></div><div id="fig-multipaneltrap" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full" data-fig.pos="h!" data-fig-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-multipaneltrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/CompTrapRule.png" class="img-fluid figure-img" style="width:75.0%" data-fig.pos="h!" data-fig-cap-location="margin">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-multipaneltrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24.1: Approximating the integral by sudviding the region into multiple “panels” and using the trapezoid rule will lead to higher accuracy
</figcaption>
</figure>
</div>
<p>The strategy is to use something simple like Trapezoid or Simpson’s Rule on each of the subregions (often called <strong><em>panels</em></strong>), and then sum up the individual contributions to arrive at the solution to the original problem. As a quick note, there is nothing in this approach that directs us to use subregions of equal size, but for exposition, we will assume that they are for the time being. We will come back to this point in the next section on adaptive methods <a href="NumIntAdaptive.html#sec-adaptive-integration" class="quarto-xref"><span>Section 25.1</span></a>.</p>
<p>In the general case, let’s assume that we have sub-divided the interval <span class="math inline">\([a,b]\)</span> Into <span class="math inline">\(r\)</span> subregions, each of equal length <span class="math inline">\(h = \frac{b-a}{r}\)</span>. See <a href="#fig-multipaneltrap" class="quarto-xref">Figure&nbsp;<span>24.1</span></a> for the case <span class="math inline">\(r=5\)</span>.</p>
<p>Then our composite quadrature rule could be written as:</p>
<p><span class="math display">\[
\int_a^b f(x) dx = \sum_{i=1}^{r} \int_{t_{i-1}}^{t_i} f(x) dx,
\]</span> where <span class="math inline">\(t_i = a + ih\)</span>. All we need do now is to apply one of our earlier quadrature formulas to the integrals in each of the subintervals <span class="math inline">\([t_{i-1},t_i]\)</span>.</p>
<p>Let’s work out an example in the simple case of the Trapezoid Rule:</p>
<p><span class="math display">\[
\begin{aligned}
\int_a^b f(x) dx &amp;\approx \sum_{i=1}^{r} \int_{t_{i-1}}^{t_i} f(x) dx, \\
&amp;\approx \sum_{i=1}^{r} \frac{h}{2} \left[ f(t_{i-1}) + f(t_i) \right], \\
&amp;= \frac{h}{2} \left[ f(t_{0}) + 2f(t_1) + 2f(t_2) + \ldots+ 2f(t_{r-1}) + f(t_r)\right], \\
&amp;= \frac{h}{2} \left[ f(a) + 2f(t_1) + 2f(t_2) + \ldots+ 2f(t_{r-1}) + f(b)\right],
\end{aligned}
\]</span> This leads to the Composite Trapezoid Rule:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Composite Trapezoidal Rule
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-comptraprule"><span class="math display">\[
\int_a^b f(x) dx = \frac{h}{2} \left[ f(a) + 2 \sum_{i=1}^{r-1}f(t_i) + f(b) \right] - \frac{(b-a)}{12} h^2 f^{\prime\prime}(\mu),
\tag{24.1}\]</span></span></p>
</div>
</div>
<p>where <span class="math inline">\(h = (b-a)/r\)</span>; <span class="math inline">\(t_i = a + ih, \  i=0, 1, \ldots, r\)</span> and <span class="math inline">\(\mu \in (a,b)\)</span>.</p>
<p>A similar exercise will lead to the Composite Simpson’s Rule:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Composite Simpson’s Rule
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-compsimprule"><span class="math display">\[
\begin{aligned}
\int_{x_0}^{x_2} f(x)dx &amp;= \frac{h}{3} [ f(a) + 2 \sum_{i=1}^{r/2-1}f(t_{2i}) + 4 \sum_{i=1}^{r/2}f(t_{2i-1}) + f(b)] \ \\
&amp;- \frac{(b-a)}{180} h^4 f^{(4)}(\mu).
\end{aligned}
\tag{24.2}\]</span></span></p>
</div>
</div>
<p>where <span class="math inline">\(h = (b-a)/r\)</span>; <span class="math inline">\(t_i = a + ih, \  i=0, 1, \ldots, r\)</span> and <span class="math inline">\(\mu \in (a,b)\)</span>.</p>
<p>The derivation for Composite Simpson’s rule isn’t difficult, and mostly a matter of getting the right indices. One observation that is helpful in deriving the formula is that because of the need for 3 nodes in Simpson’s rule we should consider the panels in pairs. For this reason, the number of panels for Simpson’s rule must always be an even number.</p>
<p><strong><em>Example:</em></strong> Let’s consider the simplest case with 4 panels, which we can group into two pairs, as depicted in the figure below. Here you should think of the first integration region spanning the first two panels so as to encompass the area in the interval <span class="math inline">\([t_0,t_2]\)</span>. Likewise, the second region will cover the interval <span class="math inline">\([t_2,t_4]\)</span>.</p>
<div id="fig-exmcompsimp" class="quarto-figure quarto-figure-center quarto-float anchored" width="60%">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exmcompsimp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/Fig-CompSimpsonsRule.png" id="fig-exmcompsimp" class="illustration img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-exmcompsimp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24.2
</figcaption>
</figure>
</div>
<p>Recall Simpson’s rule (<a href="NumIntNewtonCotes.html#eq-NC3" class="quarto-xref">Equation&nbsp;<span>23.4</span></a>),</p>
<p><span class="math display">\[
I(f) = \frac{b-a}{6} [ f(x_0) + 4f(x_1) + f(x_2)],
\]</span></p>
<p>which we can apply to each one of the two sub-intervals, <span class="math inline">\([t_0,t_2]\)</span> and <span class="math inline">\([t_2,t_4].\)</span> Let’s call the integrals over the two sub-intervals, <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2:\)</span></p>
<p><span class="math display">\[
\begin{aligned}
S_1 &amp;= \frac{t_2 - t_0}{6} [ f(t_0) + 4f(t_1) + f(t_2)], \\
S_2 &amp;= \frac{t_4 - t_2}{6} [ f(t_2) + 4f(t_3) + f(t_4)].\end{aligned}
\]</span></p>
<p>The total integral is then just the sum of these two. Here we need to notice that each sub-interval is of length <span class="math inline">\(2h\)</span>, allowing us to also simplify the sums a bit.</p>
<p><span class="math display">\[
\begin{aligned}
I(f) = \ &amp; S_1 + S_2 \\
= \ &amp;\frac{h}{3} [ f(t_0) + 4f(t_1) + f(t_2)] \  + \\
&amp; \frac{h}{3} [ f(t_2) + 4f(t_3) + f(t_4)].
\end{aligned}
\]</span></p>
<p>Now, rearraning the terms we get:</p>
<p><span class="math display">\[
\begin{aligned}
I_{Simp}(f) &amp;= \frac{h}{3} [ f(t_0) + 4f(t_1) + 2f(t_2) + 4f(t_3) + f(t_4)], \\
&amp;= \frac{h}{3} [ f(t_0) + 4 [f(t_1)+f(t_3)] + 2f(t_2) + f(t_4)].
\end{aligned}
\]</span></p>
<p>It should be clear how the general pattern follows.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>An immediate consequence of this approach is that <strong>the quadrature formulas lose one order of</strong></em> <span class="math inline">\(h\)</span> <strong><em>in their approximations.</em></strong> <em>This should not be surprising as even though each individual panel has the original truncation error, when we add up all the panels, the errors from each of the individual panels add up and we lose one order of magnitude. However, since</em> <span class="math inline">\(h\)</span> <em>is smaller, the overall result is a win!</em></p>
</div>
</div>
</section>
<section id="error-analysis-and-stability" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="error-analysis-and-stability"><span class="header-section-number">24.2</span> Error Analysis and Stability</h2>
<p>While we have a fairly good handle on the error analysis of quadrature formulas and the order of convergence, one question we haven’t addressed yet is the stability of quadrature formulas.</p>
<p>First, we know that the truncation error is well-behaved and will go to zero at varying degrees depending on the degree of the interpolating polynomial we use. What caused problems before was that roundoff error could increase dramatically leading to unstable algorithms.</p>
<p>Let’s proceed as before, by performing a floating point error analysis similar to the one we used for numerical differentiation. Recall, that we first assumed that a computation of a function value always incurs some roundoff error, in other words, we can write:</p>
<p><span class="math display">\[
f(t_i) = \hat{f}(t_i) + e_i, \ i = 0, 1, \ldots, n,
\]</span></p>
<p>where <span class="math inline">\(\hat{f}\)</span> is the floating point representation and <span class="math inline">\(e_i\)</span> is the roundoff error incurred when computing the function value. As before, we will assume that the errors are uniformly bounded:</p>
<p><span class="math display">\[
e_i &lt; \epsilon, \quad \epsilon &gt; 0.
\]</span></p>
<p>for all <span class="math inline">\(i\)</span>.</p>
<p>If we substitute into the Composite Simpson’s rule we can write the error as:</p>
<p><span class="math display">\[
\begin{aligned}
| e(h)| &amp;= \Big | \frac{h}{3} \big ( e_0 + 2 \sum_{i=1}^{r/2-1}e_{2i} + 4 \sum_{i=1}^{r/2}e_{2i-1} + e_r \big ) \Big |, \\
&amp;\leq \frac{h}{3} \big ( \epsilon + 2 (\frac{r}{2}-1)\epsilon + 4 (\frac{r}{2})\epsilon + \epsilon \big ), \\
&amp; \leq \frac{h}{3}\big ( 3r \epsilon \big ) = r h \epsilon.
\end{aligned}
\]</span></p>
<p>Finally, let’s remember that <span class="math inline">\(h= (b-a)/r,\)</span> which means that the error is bounded by:</p>
<p><span class="math display">\[
| e(h) | \leq (b-a) \ \epsilon,
\]</span>which is independent of both <span class="math inline">\(h\)</span> and <span class="math inline">\(r\)</span>.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><em>In other words, Simpson’s rule is stable!</em></strong></p>
</div>
</div>
<p>Furthermore, it should be obvious that we can do the same analysis for any of the open or closed Newton-Cotes quadrature formulas. Unlike numerical differentiation, quadrature is generarlly more stable.</p>
<div id="exr-compintexr" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 24.1</strong></span> Determine values of <span class="math inline">\(h\)</span> that will ensure an approximation error of <span class="math inline">\(&lt; 0.00002\)</span> when approximating <span class="math display">\[
\int_0^{\pi} \sin x dx
\]</span> using</p>
<ol type="1">
<li>Composite Trapezoidal Rule</li>
<li>Composite Simpson’s Rule</li>
</ol>
</div>
<p><strong>Solution:</strong></p>
<p><strong><em>Composite Trapezoid</em></strong>. Our starting point is the formula for the truncation error. For composite Trapezoid we use <a href="#eq-comptraprule" class="quarto-xref">Equation&nbsp;<span>24.1</span></a>:</p>
<p><span class="math display">\[
E(f) = -\frac{b-a}{12} h^2 f^{\prime\prime}(\xi).
\]</span></p>
<p>We would like this term to be less than the tolerance <span class="math inline">\(\epsilon = 2 \cdot 10^{-5}\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\left | E(f) \right | &amp;= \left | \frac{\pi}{12}  h^2\sin (\xi) \right| \\
&amp;= \frac{\pi}{12}  h^2 \left |  \sin (\xi) \right|  \\
&amp;\leq \frac{\pi h^2}{12} &lt; 2 \cdot 10^{-5}
\end{aligned}
\]</span> with the last inequality because <span class="math inline">\(| \sin(x) |\leq 1.\)</span></p>
<p>Solving for <span class="math inline">\(h\)</span> is then an easy matter:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\pi h^2}{12} &amp;&lt; 2 \cdot 10^{-5}, \\
h^2 &amp; &lt; \frac{24 \cdot 10^{-5} }{\pi}, \\
h &amp;&lt; \sqrt {\frac{24 \cdot 10^{-5} }{\pi}}. \\
\implies h &amp;\approx 0.00874.
\\
\end{aligned}
\]</span></p>
<p>To achieve the desired accuracy, would then require <span class="math inline">\(r = (b-a)/h\)</span> panels or <span class="math inline">\(r \approx 360\)</span> panels.</p>
<p><strong><em>Composite Simpson</em></strong>. As before, our starting point is the formula for the truncation error. For composite Simpson we use <a href="#eq-compsimprule" class="quarto-xref">Equation&nbsp;<span>24.2</span></a>:</p>
<p><span class="math display">\[
E(f) = -\frac{b-a}{180} h^4 f^{(4)}(\xi).
\]</span></p>
<p>We would like this term to be less than the tolerance <span class="math inline">\(\epsilon = 2 \cdot 10^{-5}\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\left | E(f) \right | &amp;= \left | \frac{\pi}{12}  h^4\sin (\xi) \right|, \\
&amp;= \frac{\pi}{12}  h^4 \left |  \sin (\xi) \right|,  \\
&amp;\leq \frac{\pi h^4}{180} &lt; 2 \cdot 10^{-5},
\end{aligned}
\]</span> with the last inequality because <span class="math inline">\(| \sin(x) |\leq 1.\)</span></p>
<p>Solving for <span class="math inline">\(h\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\pi h^4}{180} &amp;&lt; 2 \cdot 10^{-5}, \\
h^4 &amp; &lt; \frac{360 \cdot 10^{-5} }{\pi}, \\
h &amp;&lt; \sqrt[\LARGE{4}] {\frac{360 \cdot 10^{-5} }{\pi}}. \\
\implies  h &amp;\approx 0.18399
\end{aligned}
\]</span></p>
<p>To achieve the desired accuracy, would then require <span class="math inline">\(r = (b-a)/h\)</span> panels or <span class="math inline">\(r \approx 18\)</span> panels. For this example, it is clear that Composite Simpson is a much better choice than Composite Trapezoid.</p>
</section>
<section id="summary" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="summary"><span class="header-section-number">24.3</span> Summary</h2>
<p>There are several choices to be made when considering which quadrature method to use and what size of <span class="math inline">\(h\)</span> to choose. Deciding between a lower order method versus a higher order method can also be tricky. The error term will depend on both the size of <span class="math inline">\(h\)</span> as well as the magnitude of the highest derivative required. Choosing <span class="math inline">\(h\)</span> will require (as in the case of numerical differentiation) a balance between truncation error and roundoff error.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical Tips
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>The smaller <span class="math inline">\(h\)</span> is, the greater the accuracy for all methods; however that also implies we have more panels and hence a higher computational load.</p></li>
<li><p>If the function that is to be integrated is smooth then higher order methods are likely to work well.</p></li>
<li><p>However, if the the function is rapidly changing, then the higher derivatives will likely be large and one might want to consider lower order methods, especially if the integral interval is small.</p></li>
</ol>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(today, <span class="at">format=</span><span class="st">"Revised: %B %d %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Revised: May 07 2024"</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./NumIntNewtonCotes.html" class="pagination-link" aria-label="Newton-Cotes Methods">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Newton-Cotes Methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./NumIntAdaptive.html" class="pagination-link" aria-label="Adaptive Quadrature">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Adaptive Quadrature</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Numerical Analysis Lecture Notes, Juan C. Meza, jcmeza@ucmerced.edu, 2023</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>