<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Analysis Lecture Notes - 28&nbsp; Higher-order Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./IVPMultistep.html" rel="next">
<link href="./IVPEulerErrAny.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IVPODE.html">Initial-Value Problems for ODEs</a></li><li class="breadcrumb-item"><a href="./IVPHigherOrder.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IVPODE.html">Initial-Value Problems for ODEs</a></li><li class="breadcrumb-item"><a href="./IVPHigherOrder.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Analysis Lecture Notes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TaylorTheorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylorâ€™s Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FloatPointSys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Floating Point Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IEEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">IEEE Floating Point Standard</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AlgorithmsCondition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Stability and Conditioning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./RootsEqn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonlinear Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bisect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bisection Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Newtonâ€™s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Secant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Secant Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Fixed Point Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtEU.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Point Existence and Uniqueness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtQConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 2)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./PolyInterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolation and Approximation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpLagr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Lagrange Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpDividedDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Divided Differences and Newton Interpolating Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpErr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interpolation Error</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpCubicSplines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Piecewise Polynomials and Cubic Splines</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FwdDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Finite Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HigherOrderFD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Finite Differences via Lagrange Polynomials (Optional)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDStability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Richardson Extrapolation and Finite Difference Stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerIntegr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Integration (Quadrature)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntBasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Numerical Integration Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntNewtonCotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Newton-Cotes Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntComposite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntAdaptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Adaptive Quadrature</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./IVPODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Initial-Value Problems for ODEs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Eulerâ€™s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEulerErrAny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Error Analysis for Eulerâ€™s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPHigherOrder.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPMultistep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BigONotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Big O Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPExtUniq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Existence and Uniqueness of IVP</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">DataSets</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#higher-order-taylor-methods" id="toc-higher-order-taylor-methods" class="nav-link active" data-scroll-target="#higher-order-taylor-methods"><span class="header-section-number">28.1</span> Higher-order Taylor Methods</a></li>
  <li><a href="#runge-kutta-order-2-methods" id="toc-runge-kutta-order-2-methods" class="nav-link" data-scroll-target="#runge-kutta-order-2-methods"><span class="header-section-number">28.2</span> Runge-Kutta Order 2 Methods</a></li>
  <li><a href="#runge-kutta-order-4" id="toc-runge-kutta-order-4" class="nav-link" data-scroll-target="#runge-kutta-order-4"><span class="header-section-number">28.3</span> Runge Kutta Order 4</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">28.4</span> Summary</a></li>
  <li><a href="#general-form-for-runge-kutta-methods" id="toc-general-form-for-runge-kutta-methods" class="nav-link" data-scroll-target="#general-form-for-runge-kutta-methods"><span class="header-section-number">28.5</span> General form for Runge Kutta methods</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<hr>
<section id="higher-order-taylor-methods" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="higher-order-taylor-methods"><span class="header-section-number">28.1</span> Higher-order Taylor Methods</h2>
<p>In a similar vein to what we did to derive Eulerâ€™s method, we can derive higher-order methods by extending the Taylor series approximation to include the higher derivatives. This will yield methods that are more accurate, but at a cost of having to compute the higher derivatives.</p>
<p>There will always be a tradeoff between higher accuracy methods and computational cost. Here computational cost is usually measured in terms of function evaluations. This is important to remember because in a real-world problem each function evaluation could cost hours of computer time.</p>
<p>We note in passing that while higher-order Taylor methods can be generated, they are rarely used in practice, as the requirement of having higher-order derivatives is rarely met in real-world problems.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>If Eulerâ€™s method used a Taylor series expansion truncated after the first derivative (i.e.</em> <span class="math inline">\(n=1\)</span><em>), letâ€™s try higher values of</em> <span class="math inline">\(n\)</span><em>.</em></p>
</div>
</div>
<p>Letâ€™s start by writing down the Taylor series expansion of <span class="math inline">\(y(t)\)</span> about the current time step.</p>
<p><span class="math display">\[
\begin{aligned}
y(t_{i+1}) &amp;= y(t_i)+ h y^{\prime}(t_i) + \frac{h^2}{2} y^{\prime\prime}(t_i) + \ldots + \\ &amp; \frac{h^{(n)}}{n!} y^{(n)}(t_i) + \frac{h^{(n+1)}}{(n+1)!} y^{(n+1)}(\xi_i),  \; \xi_i \in [t+i, i_{i+1} ]
\end{aligned}
\]</span></p>
<p>Using the statement of the IVP, we know that <span class="math inline">\(y^\prime = f(t,y)\)</span>, so we can replace the derivatives of <span class="math inline">\(y\)</span> by the corresponding derivative of <span class="math inline">\(f(t,y)\)</span></p>
<p>This leads to: <span class="math display">\[
\begin{aligned}
y(t_{i+1}) &amp;= y(t_i)+ h f(t_i,y(t_i)) + \frac{h^2}{2} f^{\prime}(t_i,y(t_i)) + \ldots + \\ &amp; \frac{h^{(n)}}{n!} f^{(n-1)}(t_i,y(t_i)) + \frac{h^{(n+1)}}{(n+1)!} f^{(n)}(t_i,y(t_i)),  \; \xi_i \in [t+i, i_{i+1} ]
\end{aligned}
\]</span></p>
<p>For convenience letâ€™s denote the function <span class="math inline">\(T^{(n)}\)</span> as: <span class="math display">\[
T^{(n)} = f(t_i,y(t_i)) + \frac{h}{2} f^{\prime}(t_i,y(t_i)) + \ldots + \frac{h^{(n-1)}}{n!} f^{(n-1)}(t_i,y(t_i)).
\]</span>In a manner similar to Eulerâ€™s method, this leads us to propose the following algorithm for higher-order Taylor methods</p>
<p><span class="math display">\[
\begin{aligned}
y_0 &amp;= \alpha \\
y_{i+1} &amp;= y_i + h T^{(n)}(t_i, y_i), \; i=0, 1, \ldots, N-1.
\end{aligned}
\]</span></p>
<p><em><strong>Remark:</strong> Clearly Eulerâ€™s method is the special case of</em> <span class="math inline">\(n=1\)</span>.</p>
<p><strong><em>Remark:</em></strong> Also, <em>by the definition of the local truncation error, we can see that the higher-order Taylor method will have a local truncation error of</em> <span class="math inline">\(O(h^n)\)</span>, using the same argument that we used for Eulerâ€™s method.</p>
<p>For example, if we wanted to have a second order method, we would use <span class="math inline">\(T^{(2)}\)</span> in our difference equation:</p>
<p><span class="math display">\[
T^{(2)} = f(t_i,y(t_i)) + \frac{h}{2} f^{\prime}(t_i,y(t_i))
\]</span></p>
</section>
<section id="runge-kutta-order-2-methods" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="runge-kutta-order-2-methods"><span class="header-section-number">28.2</span> Runge-Kutta Order 2 Methods</h2>
<p>Another approach we can use leads to the well-known class of Runge-Kutta methods.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>The idea for the Runge-Kutta methods is to have the high-order local truncation error of Taylor methods <strong><em>without the need to compute and evaluate the derivatives</em></strong> <strong>of</strong> <span class="math inline">\(f(t,y)\)</span>. Ideally, we should only need function evaluations.</p>
</div>
</div>
<p>Letâ€™s first rewrite the IVP as an integral:</p>
<p><span class="math display">\[
y(t_{i+1}) = y(t_i) + \int_{t_i}^{t_{i+1}} f(t,y(t))dt.
\]</span></p>
<p>One simple idea is to now use our methods from the numerical integration sections to evaluate the integral, for example the Trapezoid rule:</p>
<p><span id="eq-ivprk0"><span class="math display">\[
y_{i+1} = y_i + \frac{h}{2}( f(t_i,y_i)+ f(t_{i+1},y_{i+1})).
\tag{28.1}\]</span></span></p>
<p>As with our discussion of Backward Euler, we can see that this is an implicit equation as <span class="math inline">\(y_{i+1}\)</span> is both on the right and left hand sides of the equation and would require the solution of a nonlinear equation.</p>
<p>But what if we could approximate the value of <span class="math inline">\(y_{i+1}\)</span> on the right hand side with an explicit method? Since we only know one explicit method (Eulerâ€™s method), letâ€™s try it out and see what happens.</p>
<p>Letâ€™s define:</p>
<p><span class="math display">\[
Y = y_i + h f(t_i,y_i),
\]</span></p>
<p>and substitute <span class="math inline">\(Y\)</span> for <span class="math inline">\(y_{i+1}\)</span> into <a href="#eq-ivprk0" class="quarto-xref">Equation&nbsp;<span>28.1</span></a>:</p>
<p><span class="math display">\[
y_{i+1} = y_i + \frac{h}{2}( f(t_i,y_i)+ f(t_{i+1},Y)).
\]</span></p>
<p>This equation is known as the <strong><em>explicit trapezoidal method</em></strong>. This method is also known as a two-stage method - the second stage comes about because we have to evaluate the function at a second point, namely <span class="math inline">\(f(t_{i+1},Y).\)</span> We can summarize this by the following steps:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explicit Trapezoid
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-explicittrap"><span class="math display">\[
\begin{aligned}
Y  &amp;= y_i + hf(t_i,y_i) \\
y_{i+1} &amp;= y_i + \frac{h}{2}(f(t_i,y_i)  + f(t_{i+1},Y)) \\
\end{aligned}
\tag{28.2}\]</span></span></p>
</div>
</div>
<p>It can be shown that this method is second order accurate.</p>
<p>A similar process but using the midpoint rule instead of the trapezoid rule will also work and yields the following two-stage algorithm, known as the <strong><em>explicit midpoint</em></strong> method:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explicit Midpoint
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-explicitmid"><span class="math display">\[
\begin{aligned}
Y &amp;= y_i + \frac{h}{2} f(t_i,y_i) \\
y_{i+1} &amp;= y_i + h f(t_{i+1/2},Y)  \\
\end{aligned}
\tag{28.3}\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Programming Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When coding the algorithms above, for example the <strong><em>explicit trapezoidal method</em></strong>, the algorithm is usually stated in terms of the following:</p>
<p><span class="math display">\[
\begin{aligned}
k_1 &amp;= f(t_i,y_i) \\
k_2 &amp;= f(t_{i+1},y_i+ hk_1) \\
y_{i+1} &amp;= y_i + \frac{h}{2}( k_1 + k_2) \\
\end{aligned}
\]</span></p>
<p>You should convince yourself that these are the same.</p>
</div>
</div>
</section>
<section id="runge-kutta-order-4" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="runge-kutta-order-4"><span class="header-section-number">28.3</span> Runge Kutta Order 4</h2>
<p>We can derive higher-order Runge-Kutta methods using similar techniques. One of the most popular is the 4th order method, which can be written as:</p>
<div class="algorithm">
<p><span class="math display">\[
\begin{aligned}
k_1 &amp;= f(t_i, y_i), \\
k_2 &amp;= f(t_{i+1/2}, y_i + \frac{h}{2}k_1), \\
k_3 &amp;= f(t_{i + 1/2}, y_i + \frac{h}{2}k_2), \\
k_4 &amp;= f(t_{i+1}, y_i + hk_3), \\
y_{i+1} &amp;= y_i + \frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4) .
\end{aligned}
\]</span></p>
</div>
<p>As the name implies, this method is <span class="math inline">\(O(h^4)\)</span>.</p>
<div id="exm-explicitmidtrap" class="theorem example">
<p><span class="theorem-title"><strong>Example 28.1</strong></span> Solve our favorite IVP problem using the Explicit Midpoint Method and the Explicit Trapezoidal method. <span class="math display">\[
\begin{aligned}
y^{\prime} &amp;= y - t^2 + 1, \quad 0 \leq t \leq 2 \\
y(0) &amp;= 0.5
\end{aligned}
\]</span></p>
<p><strong>Note:</strong> The complete worked out example for both methods can be found in the notebook Math130-IVP-RK.Rmd. Include Rmd file here???</p>
</div>
</section>
<section id="summary" class="level2" data-number="28.4">
<h2 data-number="28.4" class="anchored" data-anchor-id="summary"><span class="header-section-number">28.4</span> Summary</h2>
<ul>
<li><p>Higher-order Taylor methods can be derived, extending the accuracy of Eulerâ€™s method, although these methods are rarely use in practice.</p></li>
<li><p>Another approach is to use the same idea but replace higher derivatives of <span class="math inline">\(f\)</span> with other approximations.</p></li>
<li><p>Leads to multi-stage methods such as explicit Trapezoidal, explicit midpoint methods and the widely used and popular class of methods known as Runge-Kutta methods.</p></li>
<li><p>Choosing a good method will depend on the problem, how smooth the functions are, and the desired accuracy.</p></li>
</ul>
</section>
<section id="general-form-for-runge-kutta-methods" class="level2" data-number="28.5">
<h2 data-number="28.5" class="anchored" data-anchor-id="general-form-for-runge-kutta-methods"><span class="header-section-number">28.5</span> General form for Runge Kutta methods</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advanced - not covered in class
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>The general form of the Runge-Kutta equations with <span class="math inline">\(s\)</span> stages is given by:</p>
<p><span id="eq-genrksstage"><span class="math display">\[
y_{i+1} = y_i + h \sum_{j=1}^{s} b_j k_j,
\tag{28.4}\]</span></span></p>
<p>where the <span class="math inline">\(k_i\)</span> terms are given by:</p>
<p><span id="eq-RKsstage"><span class="math display">\[
\begin{aligned}
k_1 &amp;= f(t_i, y_i), \\
k_2 &amp;= f(t_i + h c_2, y_i + a_{21} k_1), \\
k_3 &amp;= f(t_i + h c_3, y_i + a_{31} k_1 + a_{32} k_2), \\
&amp; \vdots \\
k_s &amp;= f(t_i + h c_s, y_i + a_{s1} k_1 + a_{s2} k_2+ \ldots + a_{s,s-1} k_{s-1}), \\
\end{aligned}
\tag{28.5}\]</span></span></p>
<p>The coefficients, <span class="math inline">\(a_{ij}, b_i, c_i\)</span>, are determined by the process we introduced earlier that compares partial derivatives.</p>
<p>In addition, for consistency, we ask that the coefficients satisfy the equations: <span class="math display">\[
\sum_{j=1}^{i-1} a_{ij} = c_i, \quad i =2, \ldots, s
\]</span> and <span class="math display">\[
\sum_{j=1}^{s} b_{j} = 1,
\]</span></p>
<p>An easy way to visualize the coefficients is to use the Butcher tableau: <span class="math display">\[
\begin{array}{c|c}
c &amp; A \\
\hline
&amp; b^T
\end{array}
\]</span></p>
<p>where <span class="math inline">\(c, b\)</span> are vectors of coefficients, and <span class="math inline">\(A\)</span> is a matrix of coefficients, as defined in <a href="#eq-genrksstage" class="quarto-xref">Equation&nbsp;<span>28.4</span></a> and <a href="#eq-RKsstage" class="quarto-xref">Equation&nbsp;<span>28.5</span></a>.</p>
<p>Using this tableau, we can, for example, summarize the formula for the Runge-Kutta method of order 2 (RK2) as: <span class="math display">\[
\begin{array}{c|l}
0 &amp; 0 \\
\frac{1}{2} &amp; \frac{1}{2} \quad 0\\
\hline
&amp; 0 \quad \;1
\end{array}
\]</span> Substituting into <a href="#eq-RKsstage" class="quarto-xref">Equation&nbsp;<span>28.5</span></a> yields the formulas:</p>
<p><span class="math display">\[
\begin{aligned}
k_1 &amp;= f(t_i, y_i), \\
k_2 &amp;= f(t_i + \frac{1}{2}h, y_i + \frac{1}{2}h k_1), \\
y_{i+1} &amp;= y_i + hk_2 .
\end{aligned}
\]</span></p>
<p>We can also derive a similar set of formulas for a Runge-Kutta method with 4 stages that will yield a method of <span class="math inline">\(O(h^4)\)</span>. The corresponding tableau is given by.</p>
<p><span class="math display">\[
\begin{array}{c|l}
0 &amp; 0 \\
\frac{1}{2} &amp; \frac{1}{2} \; 0\\
\frac{1}{2} &amp; 0 \;\; \frac{1}{2} \; 0 \\
1 &amp; 0 \; \; 0 \;\; 1 \;\; 0 \\
\hline
&amp; \frac{1}{6} \; \frac{1}{3} \;\frac{1}{3} \;\frac{1}{6} \\
\end{array}
\]</span> Again, substituting into <a href="#eq-RKsstage" class="quarto-xref">Equation&nbsp;<span>28.5</span></a>, yields the Runge-Kutta method of order 4:</p>
<p><span class="math display">\[
\begin{aligned}
k_1 &amp;= f(t_i, y_i), \\
k_2 &amp;= f(t_i + \frac{1}{2}h, y_i + \frac{1}{2}h k_1), \\
k_3 &amp;= f(t_i + \frac{1}{2}h, y_i + \frac{1}{2}hk_2), \\
k_4 &amp;= f(t_i + h, y_i + hk_3), \\
y_{i+1} &amp;= y_i + \frac{1}{6}h (k_1 + 2k_2 + 2k_3 + k_4) .
\end{aligned}
\]</span></p>
<p>Recall that our goal was to replace the need for higher order derivatives while retaining the higher order local discretization error. The price we had to pay was in the form of extra function evaluations.</p>
<p>In the case of RK-2, it was an additional 2 function evaluations. For RK-4, it was 4 extra function evaluations. It can be shown that the following relationship holds between the additional function evaluations and the local discretization error holds for Runge-Kutta methods:</p>
<table class="table">
<caption>Function Evals vs.&nbsp;Local Error</caption>
<thead>
<tr class="header">
<th>Function Evaluations</th>
<th>Local Discretization Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(2\)</span></td>
<td><span class="math inline">\(O(h^2)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(3\)</span></td>
<td><span class="math inline">\(O(h^3)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(4\)</span></td>
<td><span class="math inline">\(O(h^4)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(5 \leq n \leq 7\)</span></td>
<td><span class="math inline">\(O(h^{n-1})\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(8 \leq n \leq 9\)</span></td>
<td><span class="math inline">\(O(h^{n-2})\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(10 \leq n\)</span></td>
<td><span class="math inline">\(O(h^{n-3})\)</span></td>
</tr>
</tbody>
</table>
<p>As you can see, when <span class="math inline">\(n&gt;4\)</span>, there is no big advantage to increasing the order in terms of increasing the order of the local discretization error. As a consequence, the most popular of the Runge-Kutta methods is the one of order <span class="math inline">\(4\)</span>.</p>
<hr>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(today, <span class="at">format=</span><span class="st">"Revised: %B %d %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Revised: May 07 2024"</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./IVPEulerErrAny.html" class="pagination-link" aria-label="Error Analysis for Euler's Method">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Error Analysis for Eulerâ€™s Method</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./IVPMultistep.html" class="pagination-link" aria-label="Multi-Step Methods for IVP">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Numerical Analysis Lecture Notes, Juan C. Meza, jcmeza@ucmerced.edu, 2023</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>