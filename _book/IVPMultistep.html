<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Numerical Analysis Lecture Notes - 29&nbsp; Multi-Step Methods for IVP</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./IVPHigherOrder.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IVPODE.html">Initial-Value Problems for ODEs</a></li><li class="breadcrumb-item"><a href="./IVPMultistep.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IVPODE.html">Initial-Value Problems for ODEs</a></li><li class="breadcrumb-item"><a href="./IVPMultistep.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Analysis Lecture Notes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TaylorTheorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taylor’s Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FloatPointSys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Floating Point Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IEEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">IEEE Floating Point Standard</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AlgorithmsCondition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Stability and Conditioning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./RootsEqn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonlinear Equations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bisect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bisection Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Newton’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Secant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Secant Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Fixed Point Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtEU.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fixed Point Existence and Uniqueness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FixedPtQConvg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fixed Point Iteration Convergence (Part 2)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./PolyInterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolation and Approximation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpLagr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Lagrange Polynomial Interpolation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpDividedDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Divided Differences and Newton Interpolating Polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpErr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interpolation Error</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./InterpCubicSplines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Piecewise Polynomials and Cubic Splines</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Differentiation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FwdDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Finite Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HigherOrderFD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Finite Differences via Lagrange Polynomials (Optional)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDStability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Richardson Extrapolation and Finite Difference Stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./NumerIntegr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Integration (Quadrature)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntBasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Numerical Integration Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntNewtonCotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Newton-Cotes Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntComposite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Composite Quadrature Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumIntAdaptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Adaptive Quadrature</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./IVPODE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Initial-Value Problems for ODEs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEuler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Euler’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPEulerErrAny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Error Analysis for Euler’s Method</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPHigherOrder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPMultistep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multi-Step Methods for IVP</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BigONotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Big O Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IVPExtUniq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Existence and Uniqueness of IVP</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">DataSets</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation"><span class="header-section-number">29.1</span> Motivation</a></li>
  <li><a href="#demo-basic-sir-model" id="toc-demo-basic-sir-model" class="nav-link" data-scroll-target="#demo-basic-sir-model"><span class="header-section-number">29.2</span> Demo: Basic SIR Model</a></li>
  <li><a href="#summary-of-methods-studied" id="toc-summary-of-methods-studied" class="nav-link" data-scroll-target="#summary-of-methods-studied"><span class="header-section-number">29.3</span> Summary of Methods Studied</a></li>
  <li><a href="#sec-ivpderivmultistep" id="toc-sec-ivpderivmultistep" class="nav-link" data-scroll-target="#sec-ivpderivmultistep"><span class="header-section-number">29.4</span> Derivation of multi-step methods</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">29.5</span> </a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="motivation" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">29.1</span> Motivation</h2>
<p>All the methods so far belong to a class of methods known as one-step methods, which is to say that all of the information used in the computation of the approximation at the next time step only used information from the immediately prior time step.</p>
<p>However, you might ask yourself, can we use information from other previous steps to improve our approximation. This would be especially useful in the case when each of the function evaluations are computationally expensive. This leads us to proposing a set of methods that attempt to take advantage of all of this additional information already available to us.</p>
<p>Let’s first start with some notation and a definition. As before, let’s assume that we have equally spaced time steps such that <span class="math inline">\(t_i = a + ih, i=0, 1, N.\)</span></p>
<p><strong><em>Definition:</em></strong> <em>an s-step linear multistep method for solving the IVP has a difference equation of the form:</em></p>
<p><span id="eq-mstep"><span class="math display">\[
\begin{aligned}
\sum_{j=0}^{s} \alpha_j y_{i+1-j}  = h\sum_{j=0}^{s} \beta_j f_{i+1-j},
\end{aligned}
\tag{29.1}\]</span></span> where we let <span class="math inline">\(f_{i+1-j} = f(t_{i+1-j},y_{i+1-j})\)</span>. Without loss of generality, we can assume that <span class="math inline">\(\alpha_0 = 1\)</span> since we can rescale all of the equations.</p>
<p>It will also be useful to distinguish between cases that need the function value <span class="math inline">\(f(t_{i+1},y_{i+1})\)</span> at the next time step to compute <span class="math inline">\(y_{i+1}\)</span>. In particular, if <span class="math inline">\(b_0 = 0\)</span> the method is called an <strong>explicit (open) method</strong> and we can write <a href="#eq-mstep" class="quarto-xref">Equation&nbsp;<span>29.1</span></a> as:</p>
<p><span class="math display">\[
\begin{aligned}
y_{i+1} = -\sum_{j=1}^{s} \alpha_j y_{i+1-j} + h\sum_{j=1}^{s} \beta_j f_{i+1-j}
\end{aligned}
\]</span></p>
<p>Notice that we can recover Euler’s method from the explicit form of this equation by setting <span class="math inline">\(\beta_0 = 0, s=1, \alpha_1 = -1, \beta_1 =1.\)</span></p>
<p>The second case is if we let <span class="math inline">\(b_0 \neq 0\)</span> and the method is then called <strong>implicit (closed)</strong> as <span class="math inline">\(y_{i+1}\)</span> appears on both sides of <a href="#eq-mstep" class="quarto-xref">Equation&nbsp;<span>29.1</span></a> so it is only implicitly defined.</p>
<p><span class="math display">\[
\begin{aligned}
y_{i+1} - h \beta_0 f_{i+1}= -\sum_{j=1}^{s} \alpha_j y_{i+1-j} + h\sum_{j=1}^{s} \beta_j f_{i+1-j}
\end{aligned}
\]</span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remark
</div>
</div>
<div class="callout-body-container callout-body">
<p>In general implicit methods are more accurate than explicit methods and we can get by with larger time steps. The disadvantage is that we need to solve a system of linear (or nonlinear) equations at each time step. Additionally, the solution may not be unique (or even exist).</p>
</div>
</div>
<p>How then should be develop higher-order formulas for solving the IVP. We’ve already decided that it would be good to use some of the past information and in particular, we should try to use the past values of <span class="math inline">\(y_i\)</span> that we have already computed. This leads to the following idea:</p>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use some number of past values of <span class="math inline">\(y_i\)</span> (e.g.&nbsp;<span class="math inline">\(y_i, y_{i-1}, y_{i-2}, \ldots )\)</span> to fit an <strong><em>interpolating polynomial to</em></strong> <span class="math inline">\(f\)</span>, which can then be used to derive a higher order method using techniques similar to the ones we used to derive the multi-stage (i.e.&nbsp;Explicit Trapezoid, Runge-Kutta, etc.) methods</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Figures/Fig-IVPMultiStep.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Multi-step method uses past computed values</figcaption>
</figure>
</div>
<p>There are many methods one could use to solve the IVP and we will give examples of several of the more popular multi-step methods including the Adams-Bashforth (explicit) and Adams-Moulton (implicit) methods. We will not derive the following methods here, but if you’re interested we give a brief derivation in the supplemental section <a href="#sec-ivpderivmultistep" class="quarto-xref"><span>Section 29.4</span></a>.</p>
<p><strong><em>Adams-Bashforth fourth-order</em></strong></p>
<p><span class="math display">\[
\begin{aligned}
y_0 &amp;= \alpha_0, \; y_1 = \alpha_1, \; y_2 = \alpha_2, \; y_3 = \alpha_3, \\
y_{i+1} &amp; =  y_{i} + \frac{h}{24} \left[ 55 f(t_{i}, y_{i}) -  59 f(t_{i-1}, y_{i-1}) + 37 f(t_{i-2}, y_{i-2}) - 9 f(t_{i-3}, y_{i-3}) \right]
\end{aligned}
\]</span></p>
<p><strong><em>Adams-Moulton fourth-order</em></strong></p>
<p><span class="math display">\[
\begin{aligned}
y_0 &amp;= \alpha_0, \; y_1 = \alpha_1, \; y_2 = \alpha_2, \\
y_{i+1} &amp; =  y_{i} + \frac{h}{24} \left[ 9 f(t_{i+1}, y_{i+1}) + 19 f(t_{i}, y_{i}) -  5 f(t_{i-1}, y_{i-1}) + f(t_{i-2}, y_{i-2}) \right]
\end{aligned}
\]</span></p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remark
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that in both cases, one needs to supply additional initial values. For example, in the case of Adams-Bashforth fourth-order method, we need to have 4 initial values in total. These are usually computed through an explicit method, for example a Runge-Kutta method.</p>
</div>
</div>
</section>
<section id="demo-basic-sir-model" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="demo-basic-sir-model"><span class="header-section-number">29.2</span> Demo: Basic SIR Model</h2>
<p>We demonstrated the use of a simple ODE/IVP solver by solving a problem of predicting the breakout of an epidemic using data from Merced County COVID cases taken from: <a href="https://usafacts.org/visualizations/coronavirus-covid-19-spread-map/state/california/county/merced-county/">USA Facts Merced County, California coronavirus cases and deaths</a></p>
<p>To model an epidemic of an infectious disease, the usual approach is to use what is known as the SIR Model.</p>
<p>The SIR equations are given by: <span class="math display">\[\begin{aligned}\frac{dS}{dt} &amp;= - \alpha S I  \\\frac{dI}{dt} &amp;= \alpha S I - \gamma I \\\frac{dR}{dt} &amp;= \gamma I \\N &amp;= S + I + R\end{aligned}
\]</span> where <span class="math inline">\(S\)</span> is the number of <strong>susceptible</strong> (healthy) individuals, <span class="math inline">\(I\)</span> represents the number of <strong>infected</strong> individuals, <span class="math inline">\(R\)</span> is the number of people who have <strong>recovered</strong> from the disease, and <span class="math inline">\(N\)</span> is the total population.</p>
<p>The demo we presented had 4 parameters you can play with: initial population (N), the number of days to run the simulation for, and the 2 parameters that represent the rates between susceptible and infected (<span class="math inline">\(\alpha\)</span>) and between infected and recovered (<span class="math inline">\(\gamma\)</span>).</p>
<p>The solver used comes from the deSolve package in R called ode. The default solver is “lsoda” (Petzold &amp; Hindmarsh), but other choices are available. Calling the ode solver requires the initial conditions (init), the times at which to compute the solution (times, the function to evaluate the ode (sir in this case), and a list of parameters that the ode solver passes along to the ode function.</p>
<p>The original data taken from the site gave us the following plot:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Figures/Fig-MercedCovidcases.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Merced County Covid Cases (weekly average)</figcaption>
</figure>
</div>
<p>In the demo, we played around with the parameters for the SIR model to match the data as best we could. According to the model, the basic Reproduction number <span class="math inline">\(R_0 = 8.5.\)</span> For comparison, for measles one of the more contagious diseases, <span class="math inline">\(R_0 = 12-18\)</span> while the normal flu has <span class="math inline">\(R_0 \approx 1.28\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Figures/Fig-MercedSIRdemo1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>SIR demo using Merced County data</figcaption>
</figure>
</div>
</section>
<section id="summary-of-methods-studied" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="summary-of-methods-studied"><span class="header-section-number">29.3</span> Summary of Methods Studied</h2>
<p>Let’s take a step back and summarize our main results:</p>
<table class="table">
<caption>Comparison of Different Solution Methods for IVP</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 32%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Local Truncation Error</th>
<th style="text-align: center;">Explicit/Implicit</th>
<th style="text-align: center;">Stability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Euler</td>
<td style="text-align: center;"><span class="math inline">\(\frac{hM}{2L} \left[ e^{L(t_i-a)} - 1 \right]\)</span></td>
<td style="text-align: center;">E</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Backward Euler</td>
<td style="text-align: center;"><span class="math inline">\(O(h)\)</span></td>
<td style="text-align: center;">I</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Higher Order Taylor</td>
<td style="text-align: center;"><span class="math inline">\(O(h^n)\)</span></td>
<td style="text-align: center;">E</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Midpoint</td>
<td style="text-align: center;"><span class="math inline">\(O(h^2)\)</span></td>
<td style="text-align: center;">E</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Runge-Kutta Order 2</td>
<td style="text-align: center;"><span class="math inline">\(O(h^2)\)</span></td>
<td style="text-align: center;">E</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Runge-Kutta Order 4</td>
<td style="text-align: center;"><span class="math inline">\(O(h^4)\)</span></td>
<td style="text-align: center;">E</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Adams-Bashforth</td>
<td style="text-align: center;"><span class="math inline">\(O(h^4)\)</span></td>
<td style="text-align: center;">E</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Adams-Moulton</td>
<td style="text-align: center;"><span class="math inline">\(O(h^4)\)</span></td>
<td style="text-align: center;">I</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>We did not talk much about the stability of the algorithms, but this will prove to be an important characteristic of any method we choose for an IVP.</p>
</section>
<section id="sec-ivpderivmultistep" class="level2 page-columns page-full" data-number="29.4">
<h2 data-number="29.4" class="anchored" data-anchor-id="sec-ivpderivmultistep"><span class="header-section-number">29.4</span> Derivation of multi-step methods</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advanced: Not covered in class
</div>
</div>
<div class="callout-body-container callout-body">
<p>This derivation closely follows the proof in Burden and Faires, pages 304-305.</p>
</div>
</div>
<p>First we write:</p>
<p><span class="math display">\[
\begin{aligned}
y(t_{i+1}) - y(t_{i}) &amp;= \int_{t_{i}}^{t_{i+1}} y^{\prime} (t) dt \\
&amp;= \int_{t_{i}}^{t_{i+1}} f(t, y(t)) dt
\end{aligned}
\]</span></p>
<p>Let <span class="math inline">\(y_i \approx y(t_i)\)</span>, and rearrange the equation to give us an expression for the approximation at the next time step <span class="math inline">\(t_{i+1}\)</span></p>
<p><span id="eq-yapprox"><span class="math display">\[
y(t_{i+1}) \approx y_{i} + \int_{t_{i}}^{t_{i+1}} f(t, y(t)) dt
\tag{29.2}\]</span></span></p>
<p>This should remind us of a similar problem we studied earlier, namely the numerical approximation for an integral, i.e.&nbsp;quadrature. Recall that in the earlier case, we chose to replace the function by a polynomial, for which it will be easier to compute the integral. In that case, we used a Lagrange interpolating polynomial.</p>
<p>In this case, it will be more convenient to use a <strong><em>Newton backward-difference polynomial</em></strong> because we can more easily incorporate previously calculated values.</p>
<p>As reminder we can write the <span class="math inline">\(m-1\)</span> degree interpolating polynomial as (ref: equation 3.13, p.&nbsp;130 textbook):</p>
<p><span id="eq-newtonbdpoly"><span class="math display">\[
P_{m-1} (t) =  \sum_{k=0}^{m-1}(-1)^k \binom{-s}{k} \nabla^k f(t).
\tag{29.3}\]</span></span></p>
<p>We can then use this polynomial (along with the remainder term) as an approximation to <span class="math inline">\(f(t,y)\)</span></p>
<p><span id="eq-fnewtonbd"><span class="math display">\[
f(t,y) = P_{m-1}(t) + \frac{1}{m!} f^{(m)}(\xi_i,y(\xi_i))(t - t_{i})(t - t_{i-1}) \ldots (t - t_{i+1-m})
\tag{29.4}\]</span></span></p>
<p>where <span class="math inline">\(\xi_i \in (t_{i+1-m}, t_i)\)</span>.</p>
<p>Substituting <a href="#eq-newtonbdpoly" class="quarto-xref">Equation&nbsp;<span>29.3</span></a> and <a href="#eq-fnewtonbd" class="quarto-xref">Equation&nbsp;<span>29.4</span></a> into <a href="#eq-yapprox" class="quarto-xref">Equation&nbsp;<span>29.2</span></a>, and taking the integral of both sides, yields:</p>
<p><span id="eq-fintegral"><span class="math display">\[
\begin{aligned}
\int_{t_{i}}^{t_{i+1}} f(t, y(t)) dt &amp;= \int_{t_{i}}^{t_{i+1}} \sum_{k=0}^{m-1}  (-1)^k \binom{-s}{k}\nabla^{k} f(t_i, y(t_i)) dt \\
&amp;+ \int_{t_{i}}^{t_{i+1}} \frac{1}{m!} f^{(m)}(\xi_i,y(\xi_i))(t - t_{i})(t - t_{i-1}) \ldots (t - t_{i+1-m}) dt.
\end{aligned}
\tag{29.5}\]</span></span></p>
<p>The integral is easier to solve by using the variable substitution:</p>
<p><span class="math display">\[
\begin{aligned}
t &amp;= t_i + sh \\
dt &amp;= h ds
\end{aligned}
\]</span></p>
<p>in <a href="#eq-fintegral" class="quarto-xref">Equation&nbsp;<span>29.5</span></a></p>
<p><span class="math display">\[
\begin{aligned}
\int_{t_{i}}^{t_{i+1}} f(t, y(t)) dt &amp;=  h \left[ \sum_{k=0}^{m-1} \nabla^{k} f(t_i, y(t_i)) \;  (-1)^k  \int_{0}^{1} \binom{-s}{k} ds \right] \\
&amp;+ \frac{h^{m+1}}{m!} \int_{0}^{1}  (s)(s +1) \ldots (s+m-1) f^{(m)}(\xi_i,y(\xi_i)) ds
\end{aligned}
\]</span></p>
<p>The integrals involving the binomial function are easily computed. Using the values of the computed integrals in Table 5.12, we can write the formula as</p>
<p><span class="math display">\[
\begin{aligned}
\int_{t_{i}}^{t_{i+1}} f(t, y(t)) dt &amp;= h\left[ f(t_i,y_i) + \frac{1}{2} \nabla f(t_i,y_i) + \frac{5}{12} \nabla^2 f (t_i,y_i) + \frac{3}{8} \nabla^3 f (t_i,y_i)+ \ldots \right] \\
&amp;+ \frac{h^{m+1}}{m!} \int_{0}^{1} (s)(s +1) \ldots (s+m-1) f^{(m)}(\xi_i,y(\xi_i)) ds
\end{aligned}
\]</span></p>
<p><em><strong>Note:</strong> The header in Table 5.12 in your textbook incorrectly states the second column. It should read</em> <span class="math inline">\((-1)^k \int_0^1 \binom{-s}{k}ds\)</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Recall that <span class="math inline">\(\nabla p_n = p_n - p_{n-1}, n \geq 1\)</span> and <span class="math inline">\(\nabla^{k} p_n = \nabla ( \nabla^{k-1} p_n ), k \geq 2\)</span> (see p.&nbsp;130, textbook)</p>
</div></div><p>The last step is to recognize that: <span class="math display">\[
\begin{aligned}
\nabla^0 f(t_i,y_i) &amp;= f(t_i,y_i) \\
\nabla^1 f(t_i,y_i) &amp;= f(t_i,y_i) - f(t_{i-1},y_{i-1}) \\
\nabla^2 f(t_i,y_i) &amp;= \nabla ( \nabla^1 f(t_i,y_i)) \\
\nabla^3 f(t_i,y_i) &amp;= \nabla ( \nabla^2 f(t_i,y_i))
\end{aligned}
\]</span></p>
<p>to expand the backward difference terms in the integral, followed by collecting like terms to arrive at the Adams-Bashforth Four-Step (<span class="math inline">\(m=4\)</span>) Method:</p>
<p><span class="math display">\[
\begin{aligned}
y_0 &amp;= \alpha_0, \; y_1 = \alpha_1, \; y_2 = \alpha_2, \; y_3 = \alpha_3, \\
y_{i+1} &amp; =  y_{i} + \frac{h}{24} \left[ 55 f(t_{i}, y_{i}) -  59 f(t_{i-1}, y_{i-1}) + 37 f(t_{i-2}, y_{i-2}) - 9 f(t_{i-3}, y_{i-3}) \right]
\end{aligned}
\]</span></p>
</section>
<section id="section" class="level2" data-number="29.5">
<h2 data-number="29.5" class="anchored" data-anchor-id="section"><span class="header-section-number">29.5</span> </h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(today, <span class="at">format=</span><span class="st">"Revised: %B %d %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Revised: May 07 2024"</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./IVPHigherOrder.html" class="pagination-link" aria-label="Higher-order Methods">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Higher-order Methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Numerical Analysis Lecture Notes, Juan C. Meza, jcmeza@ucmerced.edu, 2023</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>